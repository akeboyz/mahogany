<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Category</title>
  <link rel="stylesheet" href="css/category.css" />
</head>
<body>
  <div class="page-wrapper"> <!-- ‚úÖ ‡πÉ‡∏ä‡πâ class ‡∏ï‡∏£‡∏á‡∏Å‡∏±‡∏ö CSS -->

    <!-- ‚úÖ ‡∏ß‡∏¥‡∏î‡∏µ‡πÇ‡∏≠‡πÅ‡∏ö‡∏ô‡πÄ‡∏ô‡∏≠‡∏£‡πå -->
    <div class="banner-container">
      <video id="bannerVideo" autoplay muted loop playsinline>
        <source src="" type="video/mp4" />
      </video>

      <!-- ‚úÖ ‡∏õ‡∏∏‡πà‡∏°‡∏Å‡∏•‡∏±‡∏ö‡πÄ‡∏°‡∏ô‡∏π‡πÅ‡∏ö‡∏ö‡πÉ‡∏´‡∏°‡πà -->
      <div class="back-to-menu" onclick="location.href='menu.html'">
        <div class="icon">‚Ü©Ô∏è back to</div>
        <div class="label">main menu</div>
      </div>
    </div> <!-- ‚úÖ ‡∏õ‡∏¥‡∏î banner-container ‡πÉ‡∏´‡πâ‡∏ñ‡∏π‡∏Å -->

    <!-- ‚úÖ Grid ‡∏£‡πâ‡∏≤‡∏ô‡∏Ñ‡πâ‡∏≤ -->
    <div class="shop-grid" id="shopGrid"></div>

  </div>

  <script>
    // ‚úÖ ‡∏î‡∏∂‡∏á type ‡∏à‡∏≤‡∏Å URL
    const params = new URLSearchParams(window.location.search);
    const type = params.get('type') || 'dining';

    // ‚úÖ ‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï banner ‡πÉ‡∏´‡πâ‡∏ï‡∏£‡∏á‡∏Å‡∏±‡∏ö type
    const bannerVideo = document.getElementById('bannerVideo');
    bannerVideo.querySelector('source').src = `menu-vdo/${type}.mp4`;
    bannerVideo.load();

    // ‚úÖ ‡πÇ‡∏´‡∏•‡∏î‡∏£‡πâ‡∏≤‡∏ô‡∏Ñ‡πâ‡∏≤‡∏à‡∏≤‡∏Å JSON
    fetch(`data/${type}.json`)
      .then(res => res.json())
      .then(data => {
        const grid = document.getElementById('shopGrid');
        grid.innerHTML = "";

        let count = 0;

        // ‚úÖ ‡πÅ‡∏™‡∏î‡∏á‡∏£‡πâ‡∏≤‡∏ô‡∏Ñ‡πâ‡∏≤‡∏à‡∏≤‡∏Å JSON
        data.forEach(shop => {
          const div = document.createElement('div');
          div.className = 'shop-card';
          div.innerHTML = `
            <img src="${shop.image}" alt="${shop.name}" />
            <div class="shop-name">${shop.name}</div>
          `;
          grid.appendChild(div);
          count++;
        });

        // ‚úÖ ‡πÄ‡∏ï‡∏¥‡∏°‡∏ä‡πà‡∏≠‡∏á‡∏ß‡πà‡∏≤‡∏á‡πÉ‡∏´‡πâ‡∏Ñ‡∏£‡∏ö 12 ‡∏ä‡πà‡∏≠‡∏á‡πÄ‡∏™‡∏°‡∏≠
        for (let i = count; i < 12; i++) {
          const div = document.createElement('div');
          div.className = 'shop-card empty';
          grid.appendChild(div);
        }
      })
      .catch(err => {
        console.error('Error loading shop data:', err);
      });

    // ‚úÖ ‚úÖ ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏ü‡∏µ‡πÄ‡∏à‡∏≠‡∏£‡πå Auto Return ‡∏´‡∏≤‡∏Å‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Å‡∏≤‡∏£‡πÅ‡∏ï‡∏∞‡∏à‡∏≠‡πÄ‡∏Å‡∏¥‡∏ô 1 ‡∏ô‡∏≤‡∏ó‡∏µ
    let timeout;
    function resetInactivityTimer() {
      clearTimeout(timeout);
      timeout = setTimeout(() => {
        window.location.href = 'index.html';
      }, 60000); // 1 ‡∏ô‡∏≤‡∏ó‡∏µ = 60,000 ‡∏°‡∏¥‡∏•‡∏•‡∏¥‡∏ß‡∏¥‡∏ô‡∏≤‡∏ó‡∏µ
    }

    // ‚úÖ ‡∏ï‡∏£‡∏ß‡∏à‡∏à‡∏±‡∏ö‡∏Å‡∏≤‡∏£‡πÅ‡∏ï‡∏∞‡∏´‡∏£‡∏∑‡∏≠‡∏Ñ‡∏•‡∏¥‡∏Å‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏£‡∏µ‡πÄ‡∏ã‡πá‡∏ï‡πÄ‡∏ß‡∏•‡∏≤
    window.addEventListener('click', resetInactivityTimer);
    window.addEventListener('touchstart', resetInactivityTimer);
    window.addEventListener('mousemove', resetInactivityTimer);

    // ‚úÖ ‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏à‡∏±‡∏ö‡πÄ‡∏ß‡∏•‡∏≤‡πÄ‡∏°‡∏∑‡πà‡∏≠‡πÇ‡∏´‡∏•‡∏î‡∏´‡∏ô‡πâ‡∏≤
    resetInactivityTimer();
  </script>

  <!-- ‚úÖ ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡πÄ‡∏ß‡∏≠‡∏£‡πå‡∏ä‡∏±‡∏ô‡∏•‡πà‡∏≤‡∏™‡∏∏‡∏î‡∏ó‡∏∏‡∏Å 1 ‡∏ô‡∏≤‡∏ó‡∏µ ‡∏´‡∏≤‡∏Å‡πÑ‡∏°‡πà‡∏ï‡∏£‡∏á ‚Üí ‡πÇ‡∏´‡∏•‡∏î‡πÉ‡∏´‡∏°‡πà -->
  <script>
    window.currentVersion = '';

    setInterval(() => {
      fetch('/version.txt', { cache: 'no-store' })
        .then(res => res.text())
        .then(serverVersion => {
          if (window.currentVersion && window.currentVersion !== serverVersion.trim()) {
            console.log('üîÅ New version detected ‚Üí Reloading...');
            location.reload();
          }
          window.currentVersion = serverVersion.trim();
        });
    }, 60000);
  </script>
</body>
</html>